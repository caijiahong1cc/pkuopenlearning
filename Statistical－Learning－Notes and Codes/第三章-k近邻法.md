# 第三章-k近邻法

输入为实例的特征向量，对应于特征空间的点

输出为实例的类别，可以取多类

k值的选择、距离度量、分类决策规则并成为k近邻法的三要素

## 3.1 k近邻算法

 输入：训练数据集

![image-20200923162643360](C:\Users\赖凯庭\AppData\Roaming\Typora\typora-user-images\image-20200923162643360.png)

输出：实例x所属的类

（1）根据给定的距离度量，找出与x最邻近的k个点，涵盖这k个点的邻域记作Nk（x）

（2）在邻域中根据决策规则决定x的类别y

![image-20200923162947517](C:\Users\赖凯庭\AppData\Roaming\Typora\typora-user-images\image-20200923162947517.png)

k=1时称为最近邻算法

## 3.2 k近邻模型

### 3.2.1 模型

 特征空间中，对每个训练实例点，距离该点比其他点更近的所有点组成一个区域，称为单元cell

每个实例点拥有一个单元，所有的单元共同构成特征空间的一个划分

最近邻法将实例xi的类标记作为其cell中所有点的类标记

### 3.2.2 距离度量

两个点的距离是两个实例点相似程度的反映

距离可以是欧氏距离，也可以是一般的Lp距离或Minkowski距离

Lp距离的定义：

![image-20200923164025755](C:\Users\赖凯庭\AppData\Roaming\Typora\typora-user-images\image-20200923164025755.png)

这里p≥1，当p=2时，称为欧氏距离

![image-20200923164438904](C:\Users\赖凯庭\AppData\Roaming\Typora\typora-user-images\image-20200923164438904.png)

当p=1时，称为曼哈顿距离，即

![image-20200923164522014](C:\Users\赖凯庭\AppData\Roaming\Typora\typora-user-images\image-20200923164522014.png)

当p趋向于无穷时，是各个坐标距离的最大值

![image-20200923164603259](C:\Users\赖凯庭\AppData\Roaming\Typora\typora-user-images\image-20200923164603259.png)

由不同的距离度量所确定的最近邻点是不同的

### 3.2.3 k值的选择

（1）选择较小的k值：近似误差会减小，只有与输入实例相近的点才会对预测结果起作用，但估计误差会增大，预测结果会对近邻的实例点非常敏感，容易发生过拟合

（2）选择较大的k值：可以减少估计误差，但会增大近似误差，对实例点较远的点也会对预测起作用

### 3.2.4 分类决策规则

往往是多数表决，即由与输入实例的k个邻近的训练实例中的多数类决定输入实例的类

误分类的概率可以表示为：

![image-20200923165420018](C:\Users\赖凯庭\AppData\Roaming\Typora\typora-user-images\image-20200923165420018.png)

因此要使误分类率最小即经验风险最小，就要使邻域内同一分类的最大，因此多数表决规则等价于经验风险最小

## 3.3 k近邻法的实现：kd树

实现k近邻法时，最重要的问题是对数据进行快速搜索

最简单的方法是线性扫描，但耗时过大

比较成熟的方法由kd树方法

### 3.3.1 构造kd树

构造kd树相当于不断用垂直于坐标轴的超平面对k维空间进行空间划分，每个结点对应于一个k维超矩形区域

构造kd树的方法：

（1）构造根节点，使根节点对应于k维空间中包含全部实例点的超矩形区域

（2）递归对空间进行切分，生成子节点

具体递归方法：选择一个坐标轴及在此坐标轴上的一个切分点，一线一点可以确定一个面，该超平面将实例点划分成两个区域

递归终止条件：子区域内没有实例，此时kd树的节点为叶节点

**通常，依次选择坐标轴进行划分，选择训练实例点在选定坐标轴上的中位数为切分点，此时kd树达到最优（？）**

#### 算法3.2 构造平衡kd树

![image-20200923182730992](C:\Users\赖凯庭\AppData\Roaming\Typora\typora-user-images\image-20200923182730992.png)

#### 例3.2

### 3.3.2 搜索kd树

给定一个目标点，搜索其最近邻。首先找到包含目标点的叶结点:然后从该叶结点出发 ，依次回退到父结点:不断查找与目标点最邻近的结

点，当确定不可能存在更近的结点时终止 这样搜索就被限制在空间的局部区域上，效率大为提高。

#### 算法3.3 用kd树的最近邻搜索

![image-20200923185025867](C:\Users\赖凯庭\AppData\Roaming\Typora\typora-user-images\image-20200923185025867.png)

####  例3.3

















